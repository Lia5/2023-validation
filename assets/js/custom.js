document.addEventListener("DOMContentLoaded",function(){const t=document.querySelector(".form-file__input"),n=document.querySelector(".form-file__empty"),r=document.querySelector(".form-file__fill"),s=document.querySelector(".form-file__name"),o=document.querySelector(".form-file__size");var e=document.querySelector(".form-file__clear");const i=document.querySelector(".form-file__error"),a=document.querySelector(".form-section__label-number"),c=document.querySelector(".steps");var l=document.querySelectorAll(".move-to-step");const u=document.querySelectorAll(".required");var d=document.querySelector(".form-line__input");u.forEach(t=>{t.addEventListener("input",function(e){""!==this.value&&t.classList.remove("show-error")})}),d.addEventListener("input",function(e){var t=this.value,n=t.replace(/[^0-9+]/g,"");n!==t&&(this.value=n)}),l.forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var e=this.getAttribute("href").slice(1),t=document.getElementById(e);switch(e){case"step1":a.innerHTML=1;break;case"step2":if(!function(){for(const e of u)""==e.value?e.classList.add("show-error"):e.classList.remove("show-error");for(const t of u)if(t.classList.contains("show-error"))return!1;return!0}())return;a.innerHTML=2}this.closest(".step").classList.add("hide"),t.classList.remove("hide")})}),t.addEventListener("change",function(){var e=t.files;0!==e.length?(n.classList.add("hide"),r.classList.remove("hide"),s.innerHTML=t.files[0].name,o.innerHTML=(t.files[0].size/1024).toFixed(1)+" kb"):(n.classList.remove("hide"),r.classList.add("hide"))}),e.addEventListener("click",()=>{t.value="",n.classList.remove("hide"),r.classList.add("hide"),i.html="",i.classList.add("hide")});function f(){var e=c.elements,t=(console.log("formElements",e),document.querySelectorAll('[name^="questions_"]')),t=Array.from(t).map(e=>e.closest(".form-line").querySelector(".form-line__label").textContent);let n="",r="",s="";0<e.file.files.length&&(o=e.file.files[0],n=o.name,r=o.name.match(/\.[0-9a-z]+$/i)[0].substr(1),s=o.size);var o={contactInfo:{phone:e.contactInfo_phone.value,city:e.contactInfo_city.value,country:e.contactInfo_country.value,name:e.contactInfo_name.value},questions:[{question:t[0],answer:e.questions_1.value},{question:t[1],answer:e.questions_2.value},{question:t[2],answer:e.questions_3.value},{question:t[3],answer:e.questions_4.value},{question:t[4],answer:e.questions_other.value}],file:{name:n,format:r,size:s}},t=JSON.stringify(o);fetch("https://my-json-server.typicode.com/Nezdara/form-fake-server/data",{method:"POST",headers:{"Content-Type":"application/json"},body:t}).then(e=>{if(e.ok)return e.json();throw new Error("Sending Error")}).then(e=>{alert("Response: success "+JSON.stringify(e))}).catch(e=>{alert("Error message: "+e.message)})}c.addEventListener("submit",e=>{e.preventDefault(),""!=t.value&&!function(e){var t=e.files[0].size/1024,e=e.value;if(1e4<t)i.innerHTML=`file too big: ${(t/1e3).toFixed(2)} mb`;else{if(/(\.doc|\.docx|\.rtf|\.txt)$/i.exec(e))return i.innerHTML="",i.classList.add("hide"),!0;i.innerHTML="Unknown file format. Please use .doc, .docx, .rtf, .txt files."}i.classList.remove("hide")}(t)||f()})});